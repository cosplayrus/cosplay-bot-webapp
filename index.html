<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosplay Community</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: #ffffff;
            line-height: 1.6;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
            border-bottom: 2px solid #333;
        }

        .header h1 {
            color: #ff6b6b;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            color: #888;
            font-size: 16px;
        }

        .nav-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 30px;
        }

        .scroll-btn {
            background: #2a2a2a;
            color: #ffffff;
            border: 1px solid #333;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .scroll-btn:disabled {
            opacity: 0.4;
            cursor: default;
        }

        .nav-scroll {
            flex: 1;
            background: #2a2a2a;
            border-radius: 12px;
            padding: 4px;
            overflow-x: auto;
            overflow-y: hidden;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE 10+ */
        }

        .nav-scroll::-webkit-scrollbar { /* Chrome/Safari */
            display: none;
        }

        .nav-tabs {
            display: flex;
            gap: 4px;
            width: max-content;
        }

        .nav-tab {
            flex: 0 0 auto;
            padding: 12px;
            text-align: center;
            background: transparent;
            border: none;
            color: #888;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-tab.active {
            background: #ff6b6b;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #333;
        }

        .card h3 {
            color: #ff6b6b;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .news-item {
            background: #333;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #ff6b6b;
        }

        .news-item h4 {
            color: #fff;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .news-item p {
            color: #ccc;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .news-meta {
            color: #888;
            font-size: 12px;
        }

        .cosplayer-item {
            display: flex;
            align-items: center;
            background: #333;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .cosplayer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #ff6b6b;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
            color: white;
        }

        .cosplayer-info {
            flex: 1;
        }

        .cosplayer-name {
            color: #fff;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .cosplayer-stats {
            color: #888;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #ccc;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            background: #333;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        .btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
        }

        .btn:hover {
            background: #ff5252;
        }

        .btn-secondary {
            background: #555;
        }

        .btn-secondary:hover {
            background: #666;
        }

        .event-item {
            background: #333;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #4ecdc4;
        }

        .event-date {
            color: #4ecdc4;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .shop-item {
            background: #333;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #45b7d1;
        }

        .shop-category {
            color: #45b7d1;
            font-size: 12px;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .loading {
            text-align: center;
            color: #888;
            padding: 40px;
        }

        .error {
            background: #ff4757;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .success {
            background: #2ed573;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé≠ Cosplay Community</h1>
            <p>–í–∞—à –∫–æ—Å–ø–ª–µ–π –º–∏—Ä –≤ Telegram</p>
        </div>

        <div class="nav-container">
            <button class="scroll-btn" id="nav-left" aria-label="–í–ª–µ–≤–æ">‚óÄ</button>
            <div class="nav-scroll" id="nav-scroll">
                <div class="nav-tabs">
                    <button class="nav-tab active" onclick="showTab(event,'news')">üì∞ –ù–æ–≤–æ—Å—Ç–∏</button>
                    <button class="nav-tab" onclick="showTab(event,'top')">üìä –¢–æ–ø</button>
                    <button class="nav-tab" onclick="showTab(event,'register')">üë§ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                    <button class="nav-tab" onclick="showTab(event,'events')">üé™ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</button>
                    <button class="nav-tab" onclick="showTab(event,'shops')">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω—ã</button>
                </div>
            </div>
            <button class="scroll-btn" id="nav-right" aria-label="–í–ø—Ä–∞–≤–æ">‚ñ∂</button>
        </div>

        <!-- –ù–æ–≤–æ—Å—Ç–∏ -->
        <div id="news" class="tab-content active">
            <div class="card">
                <h3>üì∞ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h3>
                <div id="news-list">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π...</div>
                </div>
            </div>
        </div>

        <!-- –¢–æ–ø –∫–æ—Å–ø–ª–µ–µ—Ä–æ–≤ -->
        <div id="top" class="tab-content">
            <div class="card">
                <h3>üìä –¢–æ–ø –∫–æ—Å–ø–ª–µ–µ—Ä–æ–≤</h3>
                <div id="top-list">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞...</div>
                </div>
            </div>
        </div>

        <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
        <div id="register" class="tab-content">
            <div class="card">
                <h3>üë§ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ—Å–ø–ª–µ–µ—Ä–∞</h3>
                <form id="registration-form">
                    <div class="form-group">
                        <label for="cosplay-name">–í–∞—à –Ω–∏–∫:</label>
                        <input type="text" id="cosplay-name" required>
                    </div>
                    <div class="form-group">
                        <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                        <textarea id="description" rows="3" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ –∏ —Å–≤–æ–∏—Ö –∫–æ—Å–ø–ª–µ—è—Ö..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="fandoms">–§–∞–Ω–¥–æ–º—ã:</label>
                        <input type="text" id="fandoms" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞ –∫–∞–∫–∏–µ —Ñ–∞–Ω–¥–æ–º—ã —É –≤–∞—Å –±—ã–ª–∏ –∫–æ—Å–ø–ª–µ–∏...">
                    </div>
                    <div class="form-group">
                        <label for="telegram-channel">–í–∞—à —Ç–µ–ª–µ–≥—Ä–∞–º –∫–∞–Ω–∞–ª:</label>
                        <input type="url" id="telegram-channel" placeholder="–£–∫–∞–∂–∏—Ç–µ –ø–æ–ª–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à —Ç–≥–∫ –∫–∞–Ω–∞–ª...">
                    </div>
                                         <button type="submit" class="btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                 </form>
                 
                 
            </div>
        </div>

        <!-- –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è -->
        <div id="events" class="tab-content">
            <div class="card">
                <h3>üé™ –ö–æ—Å–ø–ª–µ–π –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h3>
                <div id="events-list">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π...</div>
                </div>
            </div>
        </div>

        <!-- –ú–∞–≥–∞–∑–∏–Ω—ã -->
        <div id="shops" class="tab-content">
            <div class="card">
                <h3>üõçÔ∏è –ê–Ω–∏–º–µ –º–∞–≥–∞–∑–∏–Ω—ã</h3>
                <div id="shops-list">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // –ü–æ–∫–∞–∑ –≤–∫–ª–∞–¥–æ–∫
        function showTab(event, tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            const buttons = document.querySelectorAll('.nav-tab');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName).classList.add('active');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫–Ω–æ–ø–∫–µ
            event.target.classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
            loadTabData(tabName);
        }

        // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —Ç–∞–±–æ–≤
        const navScroll = document.getElementById('nav-scroll');
        const btnLeft = document.getElementById('nav-left');
        const btnRight = document.getElementById('nav-right');

        function updateScrollButtons() {
            const maxScrollLeft = navScroll.scrollWidth - navScroll.clientWidth;
            btnLeft.disabled = navScroll.scrollLeft <= 0;
            btnRight.disabled = navScroll.scrollLeft >= maxScrollLeft - 1;
        }

        function smoothScrollBy(amount) {
            navScroll.scrollBy({ left: amount, behavior: 'smooth' });
        }

        btnLeft.addEventListener('click', () => smoothScrollBy(-140));
        btnRight.addEventListener('click', () => smoothScrollBy(140));
        navScroll.addEventListener('scroll', updateScrollButtons);
        window.addEventListener('resize', updateScrollButtons);
        // –ü–µ—Ä–≤–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫
        updateScrollButtons();

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
        function loadTabData(tabName) {
            switch(tabName) {
                case 'news':
                    loadNews();
                    break;
                case 'top':
                    loadTopCosplayers();
                    break;
                case 'register':
                    loadRegistration();
                    break;
                case 'events':
                    loadEvents();
                    break;
                case 'shops':
                    loadShops();
                    break;
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π
        function loadNews() {
            const newsList = document.getElementById('news-list');
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç API –∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É –±–æ—Ç—É
            newsList.innerHTML = `
                <div class="news-item">
                    <h4>üé≠ –ù–æ–≤—ã–π –∫–æ—Å–ø–ª–µ–π —Ñ–µ—Å—Ç–∏–≤–∞–ª—å –≤ –ú–æ—Å–∫–≤–µ!</h4>
                    <p>–£–∂–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ —Å–æ—Å—Ç–æ–∏—Ç—Å—è –≥—Ä–∞–Ω–¥–∏–æ–∑–Ω—ã–π –∫–æ—Å–ø–ª–µ–π —Ñ–µ—Å—Ç–∏–≤–∞–ª—å —Å —É—á–∞—Å—Ç–∏–µ–º –∑–≤–µ–∑–¥ –∞–Ω–∏–º–µ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏.</p>
                    <div class="news-meta">–ê–≤—Ç–æ—Ä: CosplayMaster ‚Ä¢ 2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</div>
                </div>
                <div class="news-item">
                    <h4>üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–Ω–∫—É—Ä—Å–∞ –∫–æ—Å–ø–ª–µ–µ—Ä–æ–≤</h4>
                    <p>–ü–æ–¥–≤–µ–¥–µ–Ω—ã –∏—Ç–æ–≥–∏ –≤—Å–µ—Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –∫–æ–Ω–∫—É—Ä—Å–∞ –∫–æ—Å–ø–ª–µ–µ—Ä–æ–≤. –ü–æ–±–µ–¥–∏—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—Ç —Ü–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑—ã.</p>
                    <div class="news-meta">–ê–≤—Ç–æ—Ä: EventOrganizer ‚Ä¢ 1 –¥–µ–Ω—å –Ω–∞–∑–∞–¥</div>
                </div>
            `;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ø –∫–æ—Å–ø–ª–µ–µ—Ä–æ–≤
        function loadTopCosplayers() {
            const topList = document.getElementById('top-list');
            topList.innerHTML = `
                <div class="form-group">
                    <input id="top-search" type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∏–∫—É –∏–ª–∏ —Ñ–∞–Ω–¥–æ–º—É...">
                </div>
                <div id="top-items"><div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞...</div></div>
            `;

            const itemsWrap = document.getElementById('top-items');

                         async function renderTop(q = '') {
                 itemsWrap.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞...</div>';
                 
                 // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ tg.sendData
                 if (tg && tg.sendData) {
                     try {
                         tg.sendData(JSON.stringify({
                             action: 'get_top_cosplayers',
                             query: q
                         }));
                         
                         // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥–ª—É—à–∫—É –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
                         itemsWrap.innerHTML = `
                             <div class="cosplayer-item">
                                 <div class="cosplayer-avatar">üé≠</div>
                                 <div class="cosplayer-info">
                                     <div class="cosplayer-name">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                                     <div class="cosplayer-stats">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ</div>
                                 </div>
                                 <button class="btn btn-secondary" style="min-width:64px">
                                     ‚ù§Ô∏è <span class="like-count">-</span>
                                 </button>
                             </div>
                         `;
                     } catch (error) {
                         console.error('Error requesting top cosplayers:', error);
                         itemsWrap.innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</div>';
                     }
                 } else {
                     // Fallback –∑–∞–≥–ª—É—à–∫–∞
                     itemsWrap.innerHTML = `
                         <div class="cosplayer-item">
                             <div class="cosplayer-avatar">üé≠</div>
                             <div class="cosplayer-info">
                                 <div class="cosplayer-name">–ü—Ä–∏–º–µ—Ä –∫–æ—Å–ø–ª–µ–µ—Ä–∞</div>
                                 <div class="cosplayer-stats">–ê–Ω–∏–º–µ, –ú–∞–Ω–≥–∞</div>
                             </div>
                             <button class="btn btn-secondary" style="min-width:64px">
                                 ‚ù§Ô∏è <span class="like-count">5</span>
                             </button>
                         </div>
                         <div class="cosplayer-item">
                             <div class="cosplayer-avatar">üé≠</div>
                             <div class="cosplayer-info">
                                 <div class="cosplayer-name">–î—Ä—É–≥–æ–π –∫–æ—Å–ø–ª–µ–µ—Ä</div>
                                 <div class="cosplayer-stats">–ò–≥—Ä—ã, –§–∏–ª—å–º—ã</div>
                             </div>
                             <button class="btn btn-secondary" style="min-width:64px">
                                 ‚ù§Ô∏è <span class="like-count">3</span>
                             </button>
                         </div>
                     `;
                 }
             }

            document.getElementById('top-search').addEventListener('input', (e) => {
                renderTop(e.target.value.trim());
            });

            renderTop('');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
        function loadEvents() {
            const eventsList = document.getElementById('events-list');
            eventsList.innerHTML = `
                <div class="event-item">
                    <div class="event-date">15 –¥–µ–∫–∞–±—Ä—è 2024</div>
                    <h4>–ó–∏–º–Ω–∏–π –∫–æ—Å–ø–ª–µ–π —Ñ–µ—Å—Ç–∏–≤–∞–ª—å</h4>
                    <p>–ì—Ä–∞–Ω–¥–∏–æ–∑–Ω–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –¥–ª—è –≤—Å–µ—Ö –ª—é–±–∏—Ç–µ–ª–µ–π –∫–æ—Å–ø–ª–µ—è –≤ —Ü–µ–Ω—Ç—Ä–µ –ú–æ—Å–∫–≤—ã.</p>
                    <div class="news-meta">üìç –ú–æ—Å–∫–≤–∞, –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–∞—Ä–∫</div>
                </div>
                <div class="event-item">
                    <div class="event-date">22 –¥–µ–∫–∞–±—Ä—è 2024</div>
                    <h4>–ê–Ω–∏–º–µ –∫–æ–Ω–≤–µ–Ω—Ç "Otaku Winter"</h4>
                    <p>–¢—Ä–µ—Ö–¥–Ω–µ–≤–Ω—ã–π –∫–æ–Ω–≤–µ–Ω—Ç —Å –∫–æ—Å–ø–ª–µ–π –∫–æ–Ω–∫—É—Ä—Å–∞–º–∏, –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–∞–º–∏ –∏ —è—Ä–º–∞—Ä–∫–æ–π.</p>
                    <div class="news-meta">üìç –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –≠–∫—Å–ø–æ—Ñ–æ—Ä—É–º</div>
                </div>
            `;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤
        function loadShops() {
            const shopsList = document.getElementById('shops-list');
            shopsList.innerHTML = `
                <div class="shop-item">
                    <div class="shop-category">–ö–æ—Å—Ç—é–º—ã</div>
                    <h4>CosplayStore.ru</h4>
                    <p>–ú–∞–≥–∞–∑–∏–Ω –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–æ—Å–ø–ª–µ–π –∫–æ—Å—Ç—é–º–æ–≤ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤.</p>
                    <div class="news-meta">üåê cosplaystore.ru</div>
                </div>
                <div class="shop-item">
                    <div class="shop-category">–ü–∞—Ä–∏–∫–∏</div>
                    <h4>WigMaster</h4>
                    <p>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –ø–∞—Ä–∏–∫–æ–≤ –¥–ª—è –∫–æ—Å–ø–ª–µ—è.</p>
                    <div class="news-meta">üåê wigmaster.com</div>
                </div>
            `;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        async function loadRegistration() {
            const formEl = document.getElementById('registration-form');
            const user = tg.initDataUnsafe && tg.initDataUnsafe.user ? tg.initDataUnsafe.user : null;
            if (!user) return;
            
            // –î–ª—è GitHub Pages –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            // –°—Ç–∞—Ç—É—Å –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ tg.sendData
            setRegistrationState('none');
        }

        function setRegistrationState(status) {
            const formWrap = document.getElementById('registration-form');
            const parent = formWrap.parentElement;
            const oldMsg = parent.querySelector('.reg-status-msg');
            if (oldMsg) oldMsg.remove();
            let msg = '';
            if (status === 'pending') {
                msg = '<div class="loading reg-status-msg">‚åõ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏ –æ–∂–∏–¥–∞–µ—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏. –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –ø–æ–∑–∂–µ.</div>';
                formWrap.style.display = 'none';
            } else if (status === 'approved') {
                msg = '<div class="success reg-status-msg">‚úÖ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞. –í—ã —É–∂–µ –≤ —Ç–æ–ø–µ –∫–æ—Å–ø–ª–µ–µ—Ä–æ–≤.</div>';
                formWrap.style.display = 'none';
            } else if (status === 'rejected') {
                msg = '<div class="error reg-status-msg">‚ùå –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –ø–µ—Ä–µ–ø–æ–¥–∞–π—Ç–µ —Å–≤–æ—é –∑–∞—è–≤–∫—É.</div>';
                formWrap.style.display = '';
            } else if (status === 'banned') {
                msg = '<div class="error reg-status-msg">‚õî –í—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –∫–∞–∫ –∫–æ—Å–ø–ª–µ–µ—Ä –∏–∑-–∑–∞ –Ω–µ —Å–æ–±–ª—é–¥–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª.</div>';
                formWrap.style.display = 'none';
            } else {
                formWrap.style.display = '';
            }
            if (msg) {
                const div = document.createElement('div');
                div.innerHTML = msg;
                parent.insertBefore(div.firstChild, formWrap);
            }
        }

        document.getElementById('registration-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const cosplayName = document.getElementById('cosplay-name').value.trim();
            const description = document.getElementById('description').value.trim();
            const fandoms = document.getElementById('fandoms').value.trim();
            const telegramChannel = document.getElementById('telegram-channel').value.trim();
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
            if (!cosplayName) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫');
                return;
            }
            
            if (cosplayName.length < 2) {
                alert('–ù–∏–∫ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞');
                return;
            }
            
            if (cosplayName.length > 50) {
                alert('–ù–∏–∫ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π (–º–∞–∫—Å–∏–º—É–º 50 —Å–∏–º–≤–æ–ª–æ–≤)');
                return;
            }
            
            const user = tg.initDataUnsafe && tg.initDataUnsafe.user ? tg.initDataUnsafe.user : null;
            console.log('User data:', user);
            
            if (!user) {
                console.error('No user data available');
                alert('–û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram.');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤ Telegram
            if (!tg.initData) {
                alert('–û—à–∏–±–∫–∞: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç–æ —á–µ—Ä–µ–∑ Telegram');
                return;
            }
            
            const payload = {
                action: 'register_cosplayer',
                cosplay_name: cosplayName,
                description: description,
                fandoms: fandoms,
                telegram_channel: telegramChannel,
                avatar_url: user && user.photo_url ? user.photo_url : '',
                timestamp: Date.now() // –î–æ–±–∞–≤–ª—è–µ–º timestamp –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            };

            console.log('Sending registration payload:', payload);
            
            // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            let success = false;
            
            // –ú–µ—Ç–æ–¥ 1: tg.sendData (–æ—Å–Ω–æ–≤–Ω–æ–π)
            if (tg && tg.sendData) {
                console.log('Trying tg.sendData...');
                try {
                    tg.sendData(JSON.stringify(payload));
                    success = true;
                    console.log('Registration data sent via tg.sendData');
                } catch (error) {
                    console.error('Error with tg.sendData:', error);
                }
            }
            
            // –ú–µ—Ç–æ–¥ 2: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–µ (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
            if (!success) {
                console.log('Trying alternative message method...');
                success = await sendDataViaMessage(payload);
            }
            
            if (success) {
                setRegistrationState('pending');
                alert('‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –û–∂–∏–¥–∞–π—Ç–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏.');
            } else {
                alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.');
            }
        });

        // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–µ (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
        async function sendDataViaMessage(payload) {
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram Web App
                const user = tg.initDataUnsafe && tg.initDataUnsafe.user ? tg.initDataUnsafe.user : null;
                if (!user) {
                    throw new Error('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã');
                }

                // –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏
                const message = `üìù –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é\n\n` +
                    `üë§ –ù–∏–∫: ${payload.cosplay_name}\n` +
                    `üìù –û–ø–∏—Å–∞–Ω–∏–µ: ${payload.description}\n` +
                    `üé≠ –§–∞–Ω–¥–æ–º—ã: ${payload.fandoms}\n` +
                    `üì± –ö–∞–Ω–∞–ª: ${payload.telegram_channel}\n` +
                    `üÜî Telegram ID: ${user.id}\n` +
                    `üë§ Username: @${user.username || '–Ω–µ —É–∫–∞–∑–∞–Ω'}\n` +
                    `üïê –í—Ä–µ–º—è: ${new Date().toLocaleString('ru-RU')}`;

                // –ò—Å–ø–æ–ª—å–∑—É–µ–º Telegram Web App API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
                if (tg && tg.sendMessage) {
                    await tg.sendMessage(message);
                    console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ tg.sendMessage');
                    return true;
                } else {
                    // Fallback: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                    alert('–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É:\n\n' + message);
                    return true;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–µ:', error);
                return false;
            }
        }

         
         // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
         loadTabData('news');
     </script>
</body>
</html>
